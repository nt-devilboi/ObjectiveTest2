был использован lock.
он даёт возможность создавать параллельность в запросах, без опаски, что данные будут как то сломаны из-за одновременного получение и использования. 
то есть убирает шанс непредсказуемости программы
